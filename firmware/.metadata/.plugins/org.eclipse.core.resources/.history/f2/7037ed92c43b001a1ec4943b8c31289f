#include "user_io.h"

static int16_t mouse_pos[2] = { 0, 0};
static uint8_t mouse_flags = 0;


void user_io_mouse(unsigned char b, char x, char y) {

  // send mouse data as minimig expects it
  if((core_type == CORE_TYPE_MINIMIG) ||
     (core_type == CORE_TYPE_MINIMIG2)) {
    mouse_pos[X] += x;
    mouse_pos[Y] += y;
    mouse_flags |= 0x80 | (b&3);
  }

  // 8 bit core expects ps2 like data
  if((core_type == CORE_TYPE_8BIT) ||
     (core_type == CORE_TYPE_MIST2)) {
    mouse_pos[X] += x;
    mouse_pos[Y] -= y;  // ps2 y axis is reversed over usb
    mouse_flags |= 0x08 | (b&3);
  }

  // send mouse data as mist expects it
  if(core_type == CORE_TYPE_MIST)
    ikbd_mouse(b, x, y);

  if(core_type == CORE_TYPE_ARCHIE)
    archie_mouse(b, x, y);
}
